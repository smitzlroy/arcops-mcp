{
  "$schema": "https://raw.githubusercontent.com/modelcontextprotocol/mcp/main/schema/mcp.schema.json",
  "name": "arcops-mcp",
  "version": "0.2.0",
  "description": "MCP-powered operations bridge for Azure Local + AKS Arc",
  "transport": {
    "type": "http",
    "url": "http://localhost:8001"
  },
  "tools": [
    {
      "name": "arc.connectivity.check",
      "description": "Unified connectivity check for Azure Local and AKS Arc. Tests DNS, TLS, and endpoint reachability. Auto-installs Microsoft Environment Checker if needed.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "mode": {
            "type": "string",
            "enum": ["quick", "full", "endpoints-only"],
            "default": "quick",
            "description": "Check mode: quick (key endpoints), full (all checks), endpoints-only (just URLs)"
          },
          "installChecker": {
            "type": "boolean",
            "default": false,
            "description": "Auto-install Microsoft Environment Checker if not present"
          },
          "checkerPath": {
            "type": "string",
            "description": "Path to Environment Checker (auto-detected if not specified)"
          },
          "configPath": {
            "type": "string",
            "default": "server/config/endpoints.yaml",
            "description": "Path to endpoints configuration"
          },
          "categories": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["azure-arc", "aks-arc", "azure-local", "windows-update", "monitoring", "defender", "governance", "ntp", "certificates", "gitops"]
            },
            "description": "Filter endpoints by category"
          },
          "timeoutSec": {
            "type": "integer",
            "default": 10,
            "description": "Timeout for each endpoint check"
          },
          "dryRun": {
            "type": "boolean",
            "default": false,
            "description": "Simulate checks using fixture data"
          }
        },
        "required": []
      },
      "outputSchema": {
        "$ref": "schemas/findings.schema.json"
      }
    },
    {
      "name": "aks.arc.validate",
      "description": "Validate AKS Arc cluster invariants: extension presence/health, CNI mode, version pins. Returns 'skipped' if kubeconfig is unavailable.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "kubeconfig": {
            "type": "string",
            "description": "Path to kubeconfig file (default: ~/.kube/config)"
          },
          "context": {
            "type": "string",
            "description": "Kubernetes context to use"
          },
          "checks": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["extensions", "cni", "versions", "flux", "all"]
            },
            "default": ["all"],
            "description": "Which validation checks to run"
          },
          "dryRun": {
            "type": "boolean",
            "default": false,
            "description": "Simulate execution using fixture data"
          }
        },
        "required": []
      },
      "outputSchema": {
        "$ref": "schemas/findings.schema.json"
      }
    },
    {
      "name": "arcops.diagnostics.bundle",
      "description": "Create a diagnostics bundle ZIP with findings.json, raw logs, and SHA256 manifest. Optional signing support.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "inputPaths": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Paths to JSON findings files or directories to include"
          },
          "outputDir": {
            "type": "string",
            "default": "./artifacts",
            "description": "Output directory for the bundle"
          },
          "sign": {
            "type": "boolean",
            "default": false,
            "description": "Sign the bundle (requires signing key)"
          },
          "includeLogs": {
            "type": "boolean",
            "default": true,
            "description": "Include raw log files in bundle"
          },
          "runId": {
            "type": "string",
            "description": "Custom run ID (auto-generated if not provided)"
          }
        },
        "required": []
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "bundlePath": {
            "type": "string",
            "description": "Path to the created bundle ZIP"
          },
          "manifestPath": {
            "type": "string",
            "description": "Path to the SHA256 manifest"
          },
          "runId": {
            "type": "string",
            "description": "Run ID for the bundle"
          }
        }
      }
    }
  ],
  "schemas": {
    "findings": {
      "$ref": "schemas/findings.schema.json"
    }
  },
  "metadata": {
    "author": "smitzlroy",
    "repository": "https://github.com/smitzlroy/arcops-mcp",
    "license": "MIT",
    "sovereignSafe": true,
    "offlineCapable": true
  }
}
